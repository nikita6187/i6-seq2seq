2018-02-27 22:40:08.887152: I tensorflow/core/platform/cpu_feature_guard.cc:137] Your CPU supports instructions that this TensorFlow binary was not compiled to use: SSE4.1 SSE4.2 AVX AVX2 FMA
Alignment: [[3, 3, 3, 3, 3, 3, 3], [0, 0, 0, 1, 3, 3, 3]]
-- Pre process 1 fin ---
[[7, 4, 4, 11, 11, 11, 11, 11, 11, 11], [11, 11, 11, 2, 11, 8, 4, 11, 11, 11]]
[[12, 7, 4, 4, 12, 12, 12, 12, 12, 12], [12, 12, 12, 12, 2, 12, 8, 4, 12, 12]]
[[4, 1, 1, 1, 1, 1, 1], [1, 1, 1, 2, 3, 1, 1]]
Traceback (most recent call last):
  File "/home/nikita/Desktop/i6-seq2seq-test/i6-seq2seq/neural-transducer/nt_demo_addition.py", line 78, in <module>
    training_steps_per_alignment=10)
  File "/home/nikita/Desktop/i6-seq2seq-test/i6-seq2seq/neural-transducer/neural_transducer.py", line 573, in apply_training_step
    self.teacher_forcing_targets: np.reshape(teacher_forcing, (-1, 1)),
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 889, in run
    run_metadata_ptr)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1120, in _run
    feed_dict_tensor, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1317, in _do_run
    options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1336, in _do_call
    raise type(e)(node_def, op, message)
tensorflow.python.framework.errors_impl.InvalidArgumentError: ConcatOp : Dimensions of inputs should match: shape[0] = [1,11] vs. shape[1] = [2,200]
	 [[Node: transducer_training/while/decoder/while/BasicDecoderStep/decoder/attention_wrapper/concat = ConcatV2[N=2, T=DT_FLOAT, Tidx=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"](transducer_training/while/decoder/while/Switch_8:1, transducer_training/while/decoder/while/Switch_5:1, transducer_training/while/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperSample/Fill/value)]]

Caused by op u'transducer_training/while/decoder/while/BasicDecoderStep/decoder/attention_wrapper/concat', defined at:
  File "/home/nikita/Desktop/i6-seq2seq-test/i6-seq2seq/neural-transducer/nt_demo_addition.py", line 19, in <module>
    model = Model(cons_manager=constants_manager)
  File "/home/nikita/Desktop/i6-seq2seq-test/i6-seq2seq/neural-transducer/neural_transducer.py", line 104, in __init__
    self.transducer_hidden_state_new, self.train_saver = self.build_full_transducer()
  File "/home/nikita/Desktop/i6-seq2seq-test/i6-seq2seq/neural-transducer/neural_transducer.py", line 309, in build_full_transducer
    transducer_hidden_state_new, _ = tf.while_loop(cond, body, init_state, parallel_iterations=1)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py", line 2816, in while_loop
    result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py", line 2640, in BuildLoop
    pred, body, original_loop_vars, loop_vars, shape_invariants)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py", line 2590, in _BuildLoop
    body_result = body(*packed_vars_for_body)
  File "/home/nikita/Desktop/i6-seq2seq-test/i6-seq2seq/neural-transducer/neural_transducer.py", line 290, in body
    maximum_iterations=transducer_max_output)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py", line 286, in dynamic_decode
    swap_memory=swap_memory)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py", line 2816, in while_loop
    result = loop_context.BuildLoop(cond, body, loop_vars, shape_invariants)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py", line 2640, in BuildLoop
    pred, body, original_loop_vars, loop_vars, shape_invariants)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/control_flow_ops.py", line 2590, in _BuildLoop
    body_result = body(*packed_vars_for_body)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/seq2seq/python/ops/decoder.py", line 234, in body
    decoder_finished) = decoder.step(time, inputs, state)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/seq2seq/python/ops/basic_decoder.py", line 138, in step
    cell_outputs, cell_state = self._cell(inputs, state)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/rnn_cell_impl.py", line 183, in __call__
    return super(RNNCell, self).__call__(inputs, state)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/layers/base.py", line 575, in __call__
    outputs = self.call(inputs, *args, **kwargs)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/seq2seq/python/ops/attention_wrapper.py", line 1293, in call
    cell_inputs = self._cell_input_fn(inputs, state.attention)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/contrib/seq2seq/python/ops/attention_wrapper.py", line 1103, in <lambda>
    lambda inputs, attention: array_ops.concat([inputs, attention], -1))
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/array_ops.py", line 1099, in concat
    return gen_array_ops._concat_v2(values=values, axis=axis, name=name)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/ops/gen_array_ops.py", line 706, in _concat_v2
    "ConcatV2", values=values, axis=axis, name=name)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/op_def_library.py", line 787, in _apply_op_helper
    op_def=op_def)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py", line 2956, in create_op
    op_def=op_def)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/framework/ops.py", line 1470, in __init__
    self._traceback = self._graph._extract_stack()  # pylint: disable=protected-access

InvalidArgumentError (see above for traceback): ConcatOp : Dimensions of inputs should match: shape[0] = [1,11] vs. shape[1] = [2,200]
	 [[Node: transducer_training/while/decoder/while/BasicDecoderStep/decoder/attention_wrapper/concat = ConcatV2[N=2, T=DT_FLOAT, Tidx=DT_INT32, _device="/job:localhost/replica:0/task:0/device:CPU:0"](transducer_training/while/decoder/while/Switch_8:1, transducer_training/while/decoder/while/Switch_5:1, transducer_training/while/decoder/while/BasicDecoderStep/ScheduledEmbeddingTrainingHelperSample/Fill/value)]]

